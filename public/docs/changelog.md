# 更新日志

---

## 2024/9/3

- 舞萌 DX 成绩详情现在支持查看谱面历史定数：
  ![](https://image.lxns.net/i/2024/09/03/000155.png)
- 舞萌 DX 成绩详情新增 DX Rating 计算器

## 2024/8/31

- 优化曲目查询页面样式
- 曲目查询现在可以复制 URL 分享曲目详情
- 修复舞萌 DX 部分曲目所属区域不正确的问题

## 2024/8/29

- 舞萌 DX `Song` 结构体中新增 `map` 字段，用于获取曲目所属区域
- 舞萌 DX 获取曲目列表等资源时现在可以使用 `version` 查询参数指定更多版本：
  - 舞萌 DX 2022（Ver.CN1.20）：`22000`
  - 舞萌 DX 2021（Ver.CN1.11）：`21000`
  - 舞萌 DX（Ver.CN1.01）：`20000`
  > 感谢**土豆喵**提供旧版本游戏数据
- 修复了姓名框查询中 SYNC 成绩被当作 FDX+ 成绩计算的问题

## 2024/8/22

- 成绩详情现在支持查询舞萌 DX 的 DX 分数与中二节奏的 OVER POWER
- 优化玩家详情与成绩详情的显示效果

## 2024/8/21

- 成绩详情在向下滚动时现在会在标题显示曲目名称
- 修复部分谱面物量显示不正确的问题

## 2024/8/18

- 优化长文本轮播效果与玩家称号显示效果
- 部分页面新增、优化动画效果

## 2024/7/26

- 舞萌 DX 新增接口：
  - [获取头像列表](/docs/api/maimai#get-apiv0maimaiiconlist)
  - [获取头像信息](/docs/api/maimai#get-apiv0maimaiiconicon_id)
- 部分页面新增动画效果
- 修复舞萌 DX API 返回的成绩不是历史最佳 DX 分数的问题

## 2024/7/25

- [同步游戏数据](/sync)现在支持查看同步结果（最佳成绩变动列表）：
  ![](https://image.lxns.net/i/2024/07/25/164158.png)
- 搜索曲目时，支持使用罗马音搜索曲名与艺术家
- 被移除的曲目现在会显示提示

## 2024/6/17

- 支持使用曲目 ID 搜索曲目

## 2024/6/14

- 修复舞萌 DX 首次非在线爬取时，没有获取玩家头像收藏品的问题
- 修复中二节奏部分曲目的 BPM 为 0 的问题
  > 目前变速曲的 BPM 显示可能与游戏内不一致，默认为谱面首个 BPM

## 2024/6/6

- 初步适配舞萌 DX 2024（Ver.CN1.40）：
  - 新增对宴会场谱面的支持：
    - 成绩管理、曲目查询支持查询宴谱成绩
    - 支持爬取宴谱成绩
      > [爬取谱面成绩的难度](/user/settings)需要选中 **U·TA·GE** 难度
    - 曲目列表的变化请参考[获取曲目列表](/docs/api/maimai#get-apiv0maimaisonglist)接口
    - 查询单曲最佳成绩等接口时需要将 `song_type` 设为 `utage`，`level_index` 设为 0
      > 如获取 **[協]Love You** 的最佳成绩：
      > `/api/v0/maimai/player/{friend_code}/best?song_id=100018&song_type=utage&level_index=0`
  - 获取曲目列表等资源时可以使用 `version` 查询参数指定游戏版本，默认为 `24000`
    > 可以根据需求自行修改为舞萌 DX 2023 的版本 ID（暂不支持早期版本）：`23000`
  - [获取玩家 DX Rating 趋势](/docs/api/maimai#get-apiv0maimaiplayerfriend_codetrend)接口新增 `version` 查询参数，用于获取指定游戏版本范围内的趋势，默认为 `24000`
  - [FULL SYNC 类型](/docs/api/maimai#fstype)新增 SYNC PLAY：`sync`
- 舞萌 DX、中二节奏 `Song` 结构体中新增 `disabled` 字段，用于获取曲目是否被禁用
  > 通常发生在小版本更新中曲目被删除，值为 `true` 时不会显示在 Best 50（或 Best 30、Selection 10）中
- 舞萌 DX `Song` 结构体中新增 `rights` 字段，用于获取曲目版权信息
- 新增对中二节奏 WORLD'S END 难度的支持：
  - 成绩管理、曲目查询支持查询该难度的成绩
  - 支持爬取该难度的成绩
    > [爬取谱面成绩的难度](/user/settings)需要选中 **WORLD'S END** 难度
  - 曲目列表的变化请参考[获取曲目列表](/docs/api/chunithm#get-apiv0chunithmsonglist)接口
  - 查询单曲最佳成绩等接口时需要将 `level_index` 设为 5
    > 如获取 **B.B.K.K.B.K.K.** 的 WORLD'S END 最佳成绩：
    > `/api/v0/chunithm/player/{friend_code}/best?song_id=8020&level_index=5`
- 获取中二节奏曲目列表时可以使用 `version` 查询参数指定资源版本，默认为 `20500`
- 修复中二节奏部分成绩 Rating、OVER POWER 计算有误的问题
- 修复中二节奏删除曲目会出现在 Best 30、Selection 10 中的问题
- 新增个人 API，使用个人 API 密钥可以完全访问查分器用户绑定的玩家数据
- 修复部分接口返回值不符合预期的问题

### ⚠ 破坏性变动

以下变动将会影响开发者，请检查你的代码是否受到影响：

- 删除部分过时接口：
  - 获取资源列表：`/api/v0/{resourceName}/list`
    > 请使用 `/api/v0/{game}/{resourceName}/list` 代替
  - 玩家相关：`/api/v0/player` 及其所有子接口
    > 请使用 `/api/v0/{game}/player` 代替
- 舞萌 DX、中二节奏 `Player` 结构体中删除字段：`icon_url`
- 中二节奏 `Player` 结构体 `change_over_power` 字段更名为 `over_power_progress`
- 由于资源导出工具的更新，部分字段至少会有以下变化：
  - 舞萌 DX、中二节奏收藏品的 `required` 字段现在可空，空值不再是 `[]`
  - 部分浮点数类型的字段（如 `level_value` 等）为整数时不会显示小数点

## 2024/5/31

- 舞萌 DX、中二节奏支持查询谱面详情（谱师、物量）
  > 舞萌 DX 支持查询物量达成率占比（可选模式 `101-`、`100-`、`0+`）
- 中二节奏成绩管理支持查询详细统计信息

## 2024/5/17

- 优化了姓名框查询要求曲目的体验：
  - 现在会显示总进度与单个难度下完成的曲目数量
  - 默认选中的难度现在为最高难度
- 修复姓名框查询要求曲目时，Re:MASTER 出现在其它难度的问题

## 2024/5/16

- 更新查分器主页 Logo
- 成绩详情现在如果曲名过长，会滚动显示

## 2024/5/14

- 中二节奏成绩管理支持使用乐曲分类与版本筛选成绩
- 中二节奏成绩上传历史记录现在纵轴为成绩，不再为 Rating
- 玩家在查分器查询 DX Rating 趋势时，可以选择查询的版本：
  ![](https://image.lxns.net/i/2024/05/13/174234.png)
- 查分器中的 FSD、FSD+ 文本更改为 FDX、FDX+
- 修复中二节奏曲目版本有误的问题
- 修复查分器登录时的重定向问题

## 2024/4/18

- 中二节奏现在支持爬取玩家 CLASS 勋章、玩家等级突破次数
- 中二节奏 `Player` 结构体中新增字段：
  - 玩家 CLASS 勋章：`class_emblem`
  - 玩家等级突破次数：`reborn_count`
- 修复中二节奏部分角色收藏品爬取不到的问题

## 2024/4/14

- 支持在曲目查询页查看成绩详情

## 2024/4/12

- 修复中二节奏爬取成绩时，通过最近游玩记录爬取的成绩无法正常保存的问题

## 2024/4/11

- 舞萌 DX 新增接口：[获取玩家缓存的所有最佳成绩（简化后）](/docs/api/maimai#get-apiv0maimaiplayerfriend_codescores)
- 中二节奏新增接口：[获取玩家缓存的所有最佳成绩（简化后）](/docs/api/chunithm#get-apiv0chunithmplayerfriend_codescores)
- 获取玩家 Best 50（Best 30）时，若获取到的成绩有一部分参数为空，现在不会返回 `null`，而是返回一个空数组

## 2024/4/8

- 修复了少数情况下导入成绩时，可能会出现 `internal server error` 的问题

## 2024/4/7

- 舞萌 DX 爬取谱面成绩的方式新增**自动检测**：`auto`
- 舞萌 DX 新增接口：[获取玩家 All Perfect 50](/docs/api/maimai#get-apiv0maimaiplayerfriend_codebestsap)

## 2024/3/25

- 修复中二节奏成绩分数低于 975,000 时，Rating 计算错误的问题

## 2024/3/23

- 查分器现在切换页面时，不会重复获取曲目列表
- 现在查分器里所有的曲目搜索框都支持搜索曲目别名

## 2024/3/21

- 修复爬取舞萌 DX 收藏品时，部分收藏品获取错误的问题
- 舞萌 DX 新增接口：
  - [获取收藏品分类列表](/docs/api/maimai#get-apiv0maimaicollection-genrelist)
  - [获取收藏品分类信息](/docs/api/maimai#get-apiv0maimaicollection-genrecollection_genre_id)
- 舞萌 DX `Collection` 结构体中新增 `genre` 字段，用于获取收藏品分类（日文）

## 2024/3/18

- 现在可以直接在曲目查询页创建曲目别名

## 2024/3/17

- 曲目查询现在支持查询已批准的曲目别名列表
- 修复姓名框查询要求曲目难度为 Re:MASTER 时，会显示不属于该难度曲目的问题

## 2024/3/14

- DX Rating 趋势坐标轴的日期现在为数值型，不再为类目型
  > 上传历史记录由于同一天内可能有多次上传，因此日期为类目型
- 舞萌 DX 成绩上传历史记录现在纵轴为达成率，不再为 DX Rating
- 为了方便观察达成率变化，上传历史记录现在会过滤掉达成率低于 80% 的成绩

## 2024/3/13

- 支持将成绩导出为 `.csv` 文件
- 支持导入成绩
- 优化成绩管理谱面定数筛选

## 2024/3/9

- **创建玩家信息**新增请求示例
- 修复**获取玩家信息**时，`trophy` 字段可能为空的问题

## 2024/3/7

- 舞萌 DX `Player` 结构体中新增 `icon` 字段，用于获取玩家头像
- 舞萌 DX 新增爬取配置项**允许爬取头像**：`allow_crawl_icon`
  > 允许后，每次爬取将会爬取头像并显示到玩家信息中
- 中二节奏 `Player` 结构体中新增 `character` 字段，用于获取玩家角色
- 中二节奏新增爬取配置项**允许爬取角色**：`allow_crawl_character`
  > 允许后，每次爬取将会爬取角色并显示到玩家信息中
- 舞萌 DX、中二节奏 `Player` 结构体中即将删除字段：`icon_url`
- 优化页面在手机端部分浏览器的滚动体验

## 2024/3/4

- 新增隐私设置配置项**允许读取历史成绩**：`allow_third_party_fetch_history`
  > 允许后，第三方开发者可以获取你的 DX Rating 趋势（中二节奏暂不支持）与成绩上传历史记录
- 舞萌 DX 新增接口：
  - [获取玩家 DX Rating 趋势](/docs/api/maimai#get-apiv0maimaiplayerfriend_codetrend)
  - [获取玩家成绩上传历史记录](/docs/api/maimai#get-apiv0maimaiplayerfriendcodescorehistory)
- 中二节奏新增[获取玩家成绩上传历史记录](/docs/api/chunithm#get-apiv0chunithmplayerfriendcodescorehistory)接口
- 中二节奏支持查询成绩上传历史记录

## 2024/3/2

- 曲目查询支持试听曲目

## 2024/3/1

- 成绩详情支持直接跳转查看曲目详情

## 2024/2/29

- 部分页面支持点击曲绘查看大图

## 2024/2/27

- 新增[曲目查询](/songs)，可以查询舞萌 DX 与中二节奏的曲目详情

## 2024/2/26

- 姓名框查询现在不需要强制登录使用

## 2024/2/25

- 重构姓名框查询要求曲目界面
- 姓名框查询现在支持搜索姓名框

## 2024/2/24

- 修复查询 Full Combo 姓名框曲目进度有误的问题
- 修复暗色或自动主题进入页面时的闪烁问题
- 优化成绩统计信息在手机端的显示效果
- 优化按钮点击效果

## 2024/2/21

- 修复舞萌 DX 通过增量爬取为现有成绩增加游玩时间时，有部分成绩没有生效的问题
- 修复文档标题跳转问题

## 2024/2/20

- 优化查分器页面报错与 404 提示

## 2024/2/19

- 新增爬取数据配置项**允许覆盖最佳成绩**：`allow_overwrite_best_score`
  > 允许后，每次“完整爬取”或通过第三方开发者写入时会检查成绩是否低于最佳成绩，低于则覆盖最佳成绩。

## 2024/1/30

- 将文档迁移至查分器
- 新增服务条款与隐私政策

## 2024/1/28

- 优化中二节奏[获取曲目列表](/docs/api/chunithm#get-apiv0chunithmsonglist)接口，现在更加类似舞萌 DX 的曲目列表：
  - 单曲 `genres` 字段现在更改为 `genre`，类型由 `Genre[]` 变更为 `string`
  - 单曲新增 `bpm`、`version` 字段
  - 难度新增 `note_designer`、`version` 字段
  - 难度新增 `notes` 字段，用于获取谱面不同 Note 的物量
  - 新增 `versions`、`genres` 字段
- 中二节奏[获取曲目列表](/docs/api/chunithm#get-apiv0chunithmsonglist)接口现在支持 `notes` 查询参数，控制是否包含谱面物量

## 2024/1/27

- 成绩管理现在支持筛选上传时间
- 优化成绩管理的曲目搜索体验
- 优化关于相同成绩冲突时，判断的成绩更新逻辑：
  - 增量爬取（判断游玩时间先后）：
    1. 若旧成绩没有游玩时间，则更新旧成绩的游玩时间，**不会插入新成绩**
    2. 若新成绩游玩时间与旧成绩不一致，才**会插入新成绩**
  - 完整爬取（不判断游玩时间先后）：若旧成绩有游玩时间，则**不会插入新成绩**
- 修复爬取时多次保存重复成绩的问题

## 2024/1/25

- 成绩管理现在支持手动创建成绩
- 成绩管理现在支持删除单曲成绩
- 同步游戏数据现在不需要强制登录使用

## 2024/1/21

- 支持跟随系统变更主题
- 支持通过全连、全同步筛选成绩

## 2024/1/13

- 支持查看玩家详情
- 支持获取 DX Rating 趋势图

## 2024/1/12

- 支持保存账号详情（用户名、邮箱）
- 成绩管理现在支持使用别名搜索
- 成绩管理现在支持使用曲目 ID 排序
- 修复中二节奏爬取无法正常获取到金币数量的问题

## 2024/1/9

- 修复舞萌 DX 姓名框获取进度有误的问题
- 姓名框查询支持仅显示要求曲目的姓名框

## 2024/1/7

- 修复舞萌 DX 成绩管理版本筛选有误的问题

## 2024/1/6

- 成绩管理页面现在支持查询中二节奏成绩

## 2023/12/20

- 舞萌 DX `Player` 结构体中删除字段：
  - `rating_base_url`
  - `course_rank_url`
  - `class_rank_url`

## 2023/12/19

- 新增**获取曲目别名列表**接口